<html lang="en">
    <head>
        {% extends "foods/base.html" %}
        {% block content %}
    <title>{{menu.menu_name}}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href='https://fonts.googleapis.com/css?family=Lemon' rel='stylesheet'>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@500&display=swap" rel="stylesheet">
<style>
h1 {
    font-family: 'Lemon';font-size: 32px;
}
.menuName {
    padding-top: 10px;
}
.creatorName {
    padding-top: 5;
    color: slategray;
}
.menuImage{
    float: right;
    padding-left: 120px;
    padding-top: 0px;
    padding-right: 550px;
    padding-bottom: 50px;
    width: 200px;
}
.description {

    padding-top: 30px;
    padding-right: 0;
}
.brief-info {
    text-align: center;
    padding-top: 30px;
    padding-bottom: 30px;
}
.ingredient p {

}
body {
    font-family: 'Roboto Slab', serif;
}

body h3{
    padding-bottom: 10px;
}

.main{
    /* padding: 0px; */
}

span.inline{
    display: inline-block;
    text-align: center;
    width: 200px;
    height: 50px;
    padding: 5px;
    font-weight: bolder;
}

/* Use a media query to add a break point at 800px: */
@media screen and (max-width: 800px) {
   .main, .right {
    width: 100%; /* The width is 100%, when the viewport is 800px or smaller */
  }
}
.rating-list li {
    float: right;
    color: #ddd;
    padding: 10px 5px;
}

.rating-list li:hover,
.rating-list li:hover ~ li {
    color: orange;
}

.rating-list {
    display: inline-block;
    list-style: none;
}
.checked {
    color: orange;
}
.container-fluid {
    padding-left: 120px;
    padding-top: 20px;
    padding-bottom: 80px;
}
</style>
</head>
<body>
    <div class="container-fluid">
        <div class="main" >
        <div class="menuName">
            <h1><b>{{ menu.menu_name }}</b></h1>
            
        </div>
            <div class="creatorName">
                <h5 ><b>By {{ menu.creator_name}}</b></h5>
            </div>
        </div>
        <div class="menuImage">
            <img src= "{{menu.picture_url}}" alt=menu.id >
        </div>
        <div class="main">
            <div class="description">
                <p>{{ menu.description }}</p>

            
            <div class="brief-info">
                {% if menu.number_of_ingredients != -99 and menu.energy_kcal != -99%}
                <h5>{{ menu.number_of_ingredients }} Ingredients&emsp;|&emsp;{{ menu.energy_kcal }} calories</h5>
                {% elif menu.number_of_ingredients != -99 %}
                <h5>{{ menu.number_of_ingredients }} Ingredients</h5>
                {% elif menu.energy_kcal != -99%}
                <h5>{{ menu.energy_kcal }} calories</h5>
                {% endif %}
            </div>
            <div class="card-body">   
                <h5 class="card-title">Avg rating:
                            <span class="fa fa-star {% if avg_rate > 0 %} checked {% endif %}"></span>
                            <span class="fa fa-star {% if avg_rate > 1 %} checked {% endif %}"></span>
                            <span class="fa fa-star {% if avg_rate > 2 %} checked {% endif %}"></span>
                            <span class="fa fa-star {% if avg_rate > 3 %} checked {% endif %}" ></span>
                            <span class="fa fa-star {% if avg_rate > 4 %} checked {% endif %}"></span>
                    </h5>
                    {% if user.is_authenticated %}
                    <ul class="btn btn-light list-inline rating-list">
                            <li onclick="rate(5, {{ menu.id }})">
                                <i class="fa fa-star {% if menu.rating > 4 %} checked {% endif %}" title="Rate 5"></i></li>
                            <li onclick="rate(4, {{ menu.id }})">
                                <i class="fa fa-star {% if menu.rating > 3 %} checked {% endif %}" title="Rate 4"></i></li>
                            <li onclick="rate(3, {{ menu.id }})">
                                <i class="fa fa-star {% if menu.rating > 2 %} checked {% endif %}" title="Rate 3"></i></li>
                            <li onclick="rate(2, {{ menu.id }})">
                                <i class="fa fa-star {% if menu.rating > 1 %} checked {% endif %}" title="Rate 2"></i></li>
                            <li onclick="rate(1, {{ menu.id }})">
                                <i class="fa fa-star {% if menu.rating > 0 %} checked {% endif %}" title="Rate 1"></i></li>
                    </ul>
                    {% else %}
                    <ul class="btn btn-light list-inline rating-list">
                            <li onclick="location.href='{% url 'login' %}'">
                                <i class="fa fa-star {% if menu.rating > 4 %} checked {% endif %}" title="Rate 5"></i>
                            </li>
                            <li onclick="location.href='{% url 'login' %}'">
                                <i class="fa fa-star {% if menu.rating > 3 %} checked {% endif %}" title="Rate 4"></i>
                            </li>
                            <li onclick="location.href='{% url 'login' %}'">
                                <i class="fa fa-star {% if menu.rating > 2 %} checked {% endif %}" title="Rate 3"></i>
                            </li>
                            <li onclick="location.href='{% url 'login' %}'">
                                <i class="fa fa-star {% if menu.rating > 1 %} checked {% endif %}" title="Rate 2"></i>
                            </li>
                            <li onclick="location.href='{% url 'login' %}'">
                                <i class="fa fa-star {% if menu.rating > 0 %} checked {% endif %}" title="Rate 1"></i>
                            </li>
                    </ul>
                    {% endif %}
            </div>
                <script>
                    const rate = (rating, menu_id) => {
                        console.log(`rating: ${rating}, menu: ${menu_id}`)
                        fetch(`/rate/${menu_id}/${rating}/`, {
                            method: 'GET',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        }).then(rest => {
                            window.location.reload();
                        })
                    }
                </script>
            </div>
        
        <ul>
            <h4>Comment List</h4>
        </ul>
        {% if comment_object %}
        <ul>
            {% for each_comment in comment_object %}
            <a>{{ each_comment.text }}</a>
            <a>Date {{ each_name_blog.pub_date }}</a>
            {% endfor %}
        </ul>
        {% else %}
        <p>No any comments.</p>
        {% endif %}
        
        <div id="Comment">
            <form action='.' method="POST">
                {% csrf_token %}
                <div id="Create_blog_bar">
                    <input type='text' name="newtext" placeholder="Add Your comment"/>
                </div>
                <div style="margin-top:200px;">
                    <button type="submit" class="btn btn-success btn-lg">Send</button>
                </div>
            </form>
        </div>

        <div class=ingredient>        
            <h3><b>Ingredients</b></h3>
            {% for ingredients in menu.ingredients %}
                <p>{{ingredients.wholeLine}}</p>
            {% endfor %} 
        </div>
        <div class="nutrition">
            <h3><b>Nutrition</b></h3>
            {% if menu.energy_kcal != -99 and menu.fat_kcal != -99 and menu.sugar != -99%}
            <span class="inline">
                <h6>Total calories<br></h6>
                {{ menu.energy_kcal }} calories
            </span>
            <span class="inline">
                <h6>Fat<br></h6>
                {{ menu.fat_kcal }} calories
            </span>
            <span class="inline">
                <h6>Sugar<br></h6>
                {{ menu.sugar }} grams
            </span>
            {% elif menu.energy_kcal != -99 and  menu.fat_kcal != -99 %}
            <span class="inline">
                <h6>Total calories<br></h6>
                {{ menu.energy_kcal }} calories
            </span>
            <span class="inline">
                <h6>Fat<br></h6>
                {{ menu.fat_kcal }} calories
            </span>
            {% elif menu.energy_kcal != -99 and  menu.sugar != -99%}
            <span class="inline">
                <h6>Total calories<br></h6>
                {{ menu.energy_kcal }} calories
            </span>
            <span class="inline">
                <h6>Sugar<br></h6>
                {{ menu.sugar }} grams
            </span>
            {% elif menu.fat_kcal != -99 and  menu.sugar != -99%}
            <span class="inline">
                <h6>Fat<br></h6>
                {{ menu.fat_kcal }} calories
            </span>
            <span class="inline">
                <h6>Sugar<br></h6>
                {{ menu.sugar }} grams
            </span>
            {% elif menu.energy_kcal != -99 %}
            <span class="inline">
                <h6>Total calories<br></h6>
                {{ menu.energy_kcal }} calories
            </span>
            {% elif menu.fat_kcal != -99%}
            <span class="inline">
                <h6>Fat<br></h6>
                {{ menu.fat_kcal }} calories
            </span>
            {% elif menu.sugar != -99%}
            <span class="inline">
                <h6>Sugar<br></h6>
                {{ menu.sugar }} grams
            </span>
            {% else %}
            <span class="inline">
                <h6> Nutrition are not available for this menu.</h6>
            </span>
            </b>
            {% endif %}
            
        </div>
        </div>
    </div>
</body>
</html>
{% endblock %}